on: [push]

jobs:
  taqueria-init-job:
    runs-on: ubuntu-latest
    name: Initialize a taqueria project
    steps:

      - name: Setup repo
        uses: actions/checkout@v2

      - uses: actions/setup-node@v2
        with:
          node-version: 16.13.x

      - name: taq init step
        uses: ecadlabs/taqueria-github-action@v0.0.1-rc1
        with:
          project-name: 'test-project'
          task: 'init'

      - name: initialize node
        run: |
          ls -ltra ./
          sudo cp contracts/counter.jsligo test-project/contracts/
          cd test-project
          id
          ls -ltra ./
          sudo npm init -y

      - name: install the ligo plugin
        uses: ecadlabs/taqueria-github-action@v0.0.1-rc1
        with:
          project-name: 'test-project'
          # task: 'install @taqueria/plugin-ligo-0.0.0-pr-704-cbcdf9ce'
          task: 'install @taqueria/plugin-ligo@0.0.0-pr-704-cbcdf9ce'

      - name: compile the contracts
        uses: ecadlabs/taqueria-github-action@v0.0.1-rc1
        with:
          project-name: 'test-project'
          task: 'compile'
        env:
          PROJECT_DIR: /github/workspace
